{
  "title": "-tests_test_enhancer.py",
  "text": "## [[Tags]]\n-tests_test_enhancer.py [[--ğŸ§ª tests/]] [[--- Codigo]] -src_enhancer.py\n\n```python\nimport pytest\nimport sys\nfrom pathlib import Path\nsys.path.append(str(Path(__file__).resolve().parents[1]))\n\nfrom src.enhancer import (\n    reemplazar_cid_ascii,\n    reparar_encoding,\n    normalizar_unicode,\n    reparar_palabras_partidas,\n    reparar_cid,\n    reparar_ocr_simbolos,\n    marcar_fragmentos_dudosos,\n    pipeline_hooked_enhancer,\n    enriquecer_texto\n)\n\n# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n# ğŸ§¬ Test nuevo flujo: pipeline_hooked_enhancer\n# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\ndef test_pipeline_hooked_enhancer_basico(tmp_path):\n    texto_daÃ±ado = \"cid:241 El aÃƒÂ±o 2023 fue difÃƒÂ­cil. ï¬le, ï¬‚uid, ÆŸmega.\"\n    ruta_dummy = tmp_path / \"texto_dummy.pdf\"\n    ruta_dummy.write_text(\"dummy content\")\n\n    config = {\n        \"pasos\": [\n            reemplazar_cid_ascii,\n            reparar_encoding,\n            normalizar_unicode,\n            reparar_palabras_partidas,\n            reparar_cid,\n            reparar_ocr_simbolos,\n            marcar_fragmentos_dudosos\n        ],\n        \"retry_umbral\": 1,\n        \"max_intentos\": 2\n    }\n\n    enriquecido, stats = pipeline_hooked_enhancer(texto_daÃ±ado, config)\n\n    assert \"cid:\" not in enriquecido\n    # Verifica que se corrija al menos un caracter acentuado (Ã­) tras encoding\n    assert \"Ã­\" in enriquecido, \"Debe contener al menos un carÃ¡cter acentuado (Ã­) tras la correcciÃ³n\"\n    assert \"file\" in enriquecido\n    assert \"fluid\" in enriquecido\n    assert \"Omega\" in enriquecido or \"O\" in enriquecido\n    assert \"Ãƒ\" not in enriquecido\n\n\ndef test_pipeline_hooked_enhancer_no_cambios(tmp_path):\n    texto_limpio = \"Este es un texto sin errores visibles.\"\n    ruta_dummy = tmp_path / \"texto_ok.pdf\"\n    ruta_dummy.write_text(\"dummy content\")\n\n    config = {\n        \"pasos\": [\n            reemplazar_cid_ascii,\n            reparar_encoding,\n            normalizar_unicode,\n            reparar_palabras_partidas,\n            reparar_cid,\n            reparar_ocr_simbolos,\n            marcar_fragmentos_dudosos\n        ]\n    }\n\n    enriquecido, stats = pipeline_hooked_enhancer(texto_limpio, config)\n    assert enriquecido == texto_limpio\n\n```",
  "tags": "-tests_test_enhancer.py [[--ğŸ§ª tests/]] [[--- Codigo]] -src_enhancer.py",
  "type": "text/markdown",
  "created": "20250424205039138",
  "modified": "20250424205039138"
}